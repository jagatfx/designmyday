<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/social-icons.html">
<link rel="import" href="../../bower_components/iron-icons/hardware-icons.html">
<link rel="import" href="../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">

<dom-module id="vote-head">

  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block;
        box-sizing: border-box;
        min-height: 50px;
      }

      paper-card {
        display: inline-block;
        background: white;
        box-sizing: border-box;
        margin: 16px;
        padding: 16px;
        border-radius: 2px;
        elevation: 2;
        --paper-card-header: {
            @apply(--layout-vertical);
            @apply(--layout-center);
        };
      }
      .user-card {
        display: inline-block;
        background: white;
        box-sizing: border-box;
        margin: 16px;
        padding: 16px;
        text-align: center;
        cursor: pointer;
      }

      .horizontal {
        @apply(--layout-horizontal);
      }
      .justified {
        @apply(--layout-justified);
      }

      paper-icon-button {
        color: var(--paper-grey-600);
      }

      .user-content {
        @apply(--layout-center-justified);
        text-align: center;
      }
      .city {
        text-transform: capitalize;
        font-weight: bold;
      }
      .feeling {
        font-weight: bold;
      }
      .username {
        font-weight: bold;
      }
      .step {
        font-weight: bold;
      }
      .modal-header {
        font-weight: bold;
      }
      .range-select {
        @apply(--layout-horizontal);
        @apply(--layout-center-justified);
        @apply(--layout-center);
        width: 80%;
        padding: 10px;
        margin: 0 auto;
      }
      .logout {
        text-decoration: none;
      }
      .slider-label {
        font-size: 10px;
      }
    </style>

    <div>
      <div class="page-header">
        <div class="page-title">Let's help someone <paper-icon-button class="help" icon="icons:help" data-dialog="dialog" on-tap="_showHelpDialog"></paper-icon-button></div>
      </div>

      <div class="centered-container horizontal">
        <paper-card class="user-card">
          <div class="user-content">
            <div class="card-content">
              <div>
                Meet <span class="username">[[user.votee.username]]</span>, [[user.votee.age]] years old, lives in
                <span class="city">[[user.votee.city]]</span> and feeling <span class="feeling">[[user.votee.lastFeeling]]</span>.
              </div>
              <iron-image src$="{{feelingImg}}"></iron-image>
              <div class="range-select">
                <div class="slider-label">A LITTLE</div>
                <div class="flexchild">
                  <paper-slider class="severity-slider"
                                min="1"
                                max="10"
                                value="{{user.votee.lastSeverity}}"
                                step="0.1"
                                disabled>
                  </paper-slider>
                </div>
                <div class="slider-label">A LOT</div>
              </div>
              <div>
                Help give this person an idea of what to do today.
              </div>
              <div>
                Click an activity below or suggest something new.
              </div>
            </div>
          </div>
        </paper-card>
      </div>

      <div class="centered-container">
        <a href="#/addactivity">
          <paper-button raised class="dmd-btn" on-tap="_handleNew">Suggest Something New</paper-button>
        </a>
      </div>
    </div>

    <span>{{_showIntroDialog(user)}}</span>
    <paper-dialog id="modal" entry-animation="scale-up-animation" exit-animation="fade-out-animation" with-backdrop>
      <div class="centered-container">
        <p><span class="modal-header">Welcome to Design My Day!</span><br />
        Actionable ideas from a trusted community to brighten your day and help others do the same.<br />
        Here's how it works in 3 easy steps:</p>
      </div>
      <paper-dialog-scrollable>
        <div class="horizontal centered-container wrap">
          <div>
            <h1>1</h1>
            <p class="step">Help a member of your local tribe<br />
            by voting for the activity<br />
            you think they should do today.</p>
            <iron-image src="/img/uploads/good-idea.jpg"></iron-image>
          </div>
          <div>
            <h1>2</h1>
            <p class="step">You receive ideas<br />
            for what to do today<br />
            based on how you are feeling.</p>
            <iron-image src="/img/uploads/get-suggestion.jpg"></iron-image>
          </div>
          <div>
            <h1>3</h1>
            <p class="step">Go do something<br />
            feel better!<br />
            <br />
            </p>
            <iron-image src="/img/uploads/do-something-feel-better.jpg"></iron-image>
          </div>
        </div>
        <div class="buttons">
          <paper-button dialog-confirm on-tap="_dialogContinue" autofocus>Tap here to continue</paper-button>
        </div>
      </paper-dialog-scrollable>
    </paper-dialog>

    <paper-dialog id="firstmodal" entry-animation="scale-up-animation" exit-animation="fade-out-animation" modal>
      <paper-dialog-scrollable>
        <div class="centered-container">
          <h1>First User</h1>
          <p>You are the first user in {{user.city}}. Welcome!<br />
          Since Design My Day is community-based, we need more people in your city before you can use the app.<br />
          Go invite some friends!
          </p>
          <iron-image src="/img/uploads/red-light.jpg"></iron-image>
          <div class="centered-container">
            <a class="logout" href="/logout">
              <paper-button class="dmd-btn">Logout</paper-button>
            </a>
          </div>
        </div>
      <paper-dialog-scrollable>
    </paper-dialog>

  </template>
  <script>
    Polymer({

      is: 'vote-head',

      properties: {

        activity: Object,
        user: Object,
        feelingImg: {
          type: String,
          notify: true,
          value: '/img/place-emotion.gif'
        }
      },

      observers: [
        'updateImage(user)'
      ],

      updateImage: function(user) {
        this.feelingImg = '/img/'+user.lastFeeling+'.gif';
      },

      _showIntroDialog: function(user) {
        if (!this.user.votee) {
          this.$.firstmodal.open();
        }
        else if (this.user && this.user.votesCast < 1) {
          this.$.modal.open();
        }
      },

      _showHelpDialog: function() {
        this.$.modal.open();
      },

      _dialogContinue: function() {
        this.$.modal.close();
      },

    });
  </script>
</dom-module>
